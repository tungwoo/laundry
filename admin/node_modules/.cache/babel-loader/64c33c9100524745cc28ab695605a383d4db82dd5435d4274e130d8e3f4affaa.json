{"ast":null,"code":"export default {\n  name: 'OrderCreate',\n  data() {\n    return {\n      form: this.$form.createForm(this),\n      current: 0,\n      orderForm: {\n        customerId: null,\n        customerName: '',\n        customerPhone: '',\n        customerBalance: 0,\n        clothes: [],\n        remark: '',\n        paymentMethod: 'CASH',\n        isPaid: false\n      },\n      customerSearchText: '',\n      customerSearchResults: [],\n      isNewCustomer: false,\n      newCustomer: {\n        name: '',\n        phone: '',\n        isMember: false,\n        initialBalance: 0\n      },\n      clothesModalVisible: false,\n      clothesModalMode: 'add',\n      // 'add' or 'edit'\n      editingClothesIndex: -1,\n      clothesForm: {\n        id: null,\n        categoryId: null,\n        categoryName: '',\n        name: '',\n        color: '',\n        material: '',\n        price: 0,\n        quantity: 1,\n        specialRequirements: [],\n        remark: ''\n      },\n      clothesCategories: [{\n        id: 1,\n        name: '上衣'\n      }, {\n        id: 2,\n        name: '裤子'\n      }, {\n        id: 3,\n        name: '裙子'\n      }, {\n        id: 4,\n        name: '外套'\n      }, {\n        id: 5,\n        name: '羽绒服'\n      }, {\n        id: 6,\n        name: '床单'\n      }, {\n        id: 7,\n        name: '被罩'\n      }, {\n        id: 8,\n        name: '窗帘'\n      }, {\n        id: 9,\n        name: '鞋子'\n      }, {\n        id: 10,\n        name: '包包'\n      }, {\n        id: 11,\n        name: '其他'\n      }],\n      clothesColumns: [{\n        title: '类别',\n        dataIndex: 'categoryName',\n        key: 'categoryName'\n      }, {\n        title: '名称',\n        dataIndex: 'name',\n        key: 'name'\n      }, {\n        title: '颜色',\n        dataIndex: 'color',\n        key: 'color'\n      }, {\n        title: '单价',\n        dataIndex: 'price',\n        key: 'price',\n        customRender: text => `¥${text}`\n      }, {\n        title: '数量',\n        dataIndex: 'quantity',\n        key: 'quantity'\n      }, {\n        title: '金额',\n        key: 'amount',\n        customRender: (text, record) => `¥${(record.price * record.quantity).toFixed(2)}`\n      }, {\n        title: '操作',\n        key: 'operation',\n        scopedSlots: {\n          customRender: 'operation'\n        }\n      }]\n    };\n  },\n  methods: {\n    // 步骤导航\n    next() {\n      if (this.current === 0 && !this.validateStep1()) {\n        this.$message.error('请先选择或创建客户');\n        return;\n      }\n      if (this.current === 1 && !this.validateStep2()) {\n        this.$message.error('请至少添加一件衣物');\n        return;\n      }\n      this.current++;\n    },\n    prev() {\n      this.current--;\n    },\n    // 步骤验证\n    validateStep1() {\n      if (this.isNewCustomer) {\n        return this.newCustomer.name && this.newCustomer.phone;\n      } else {\n        return this.orderForm.customerId && this.orderForm.customerName && this.orderForm.customerPhone;\n      }\n    },\n    validateStep2() {\n      return this.orderForm.clothes && this.orderForm.clothes.length > 0;\n    },\n    // 客户相关\n    searchCustomer() {\n      if (!this.customerSearchText) {\n        this.$message.warning('请输入搜索内容');\n        return;\n      }\n\n      // 模拟API请求\n      this.$message.loading('搜索中...', 1).then(() => {\n        // 这里应该调用后端API进行搜索\n        const mockResults = [{\n          id: 1,\n          name: '张三',\n          phone: '13800138000',\n          balance: 200\n        }, {\n          id: 2,\n          name: '李四',\n          phone: '13900139000',\n          balance: 350\n        }, {\n          id: 3,\n          name: '王五',\n          phone: '13700137000',\n          balance: 100\n        }];\n        this.customerSearchResults = mockResults.filter(item => item.name.includes(this.customerSearchText) || item.phone.includes(this.customerSearchText));\n        if (this.customerSearchResults.length === 0) {\n          this.$message.info('未找到符合条件的会员');\n        }\n      });\n    },\n    selectCustomer(customer) {\n      this.orderForm.customerId = customer.id;\n      this.orderForm.customerName = customer.name;\n      this.orderForm.customerPhone = customer.phone;\n      this.orderForm.customerBalance = customer.balance;\n      this.isNewCustomer = false;\n      this.customerSearchResults = [];\n      this.customerSearchText = '';\n    },\n    // 衣物相关\n    showAddClothesModal() {\n      this.clothesModalMode = 'add';\n      this.clothesForm = {\n        id: Date.now(),\n        categoryId: null,\n        categoryName: '',\n        name: '',\n        color: '',\n        material: '',\n        price: 0,\n        quantity: 1,\n        specialRequirements: [],\n        remark: ''\n      };\n      this.clothesModalVisible = true;\n    },\n    editClothes(record, index) {\n      this.clothesModalMode = 'edit';\n      this.editingClothesIndex = index;\n      this.clothesForm = {\n        ...record\n      };\n      this.clothesModalVisible = true;\n    },\n    removeClothes(index) {\n      this.orderForm.clothes.splice(index, 1);\n    },\n    handleClothesModalOk() {\n      // 验证表单\n      if (!this.clothesForm.categoryId) {\n        this.$message.error('请选择衣物类别');\n        return;\n      }\n      if (!this.clothesForm.name) {\n        this.$message.error('请输入衣物名称');\n        return;\n      }\n      if (this.clothesForm.price <= 0) {\n        this.$message.error('请输入有效的价格');\n        return;\n      }\n      if (this.clothesForm.quantity <= 0) {\n        this.$message.error('请输入有效的数量');\n        return;\n      }\n      const clothes = {\n        ...this.clothesForm\n      };\n\n      // 根据类别ID获取类别名称\n      const category = this.clothesCategories.find(item => item.id === clothes.categoryId);\n      if (category) {\n        clothes.categoryName = category.name;\n      }\n      if (this.clothesModalMode === 'add') {\n        this.orderForm.clothes.push(clothes);\n      } else if (this.clothesModalMode === 'edit') {\n        this.orderForm.clothes.splice(this.editingClothesIndex, 1, clothes);\n      }\n      this.clothesModalVisible = false;\n    },\n    handleClothesModalCancel() {\n      this.clothesModalVisible = false;\n    },\n    handleCategoryChange(value) {\n      const category = this.clothesCategories.find(item => item.id === value);\n      if (category) {\n        this.clothesForm.categoryName = category.name;\n      }\n    },\n    // 计算总金额\n    getTotalAmount() {\n      return this.orderForm.clothes.reduce((sum, item) => sum + item.price * item.quantity, 0).toFixed(2);\n    },\n    // 提交订单\n    submitOrder() {\n      // 处理新客户的逻辑\n      if (this.isNewCustomer) {\n        // 这里应该先调用创建客户的API\n        this.orderForm.customerName = this.newCustomer.name;\n        this.orderForm.customerPhone = this.newCustomer.phone;\n        if (this.newCustomer.isMember) {\n          // 创建会员的逻辑\n          this.orderForm.customerBalance = this.newCustomer.initialBalance;\n        }\n      }\n\n      // 构建提交的订单数据\n      const orderData = {\n        customerId: this.orderForm.customerId,\n        customerName: this.orderForm.customerName,\n        customerPhone: this.orderForm.customerPhone,\n        clothes: this.orderForm.clothes,\n        remark: this.orderForm.remark,\n        paymentMethod: this.orderForm.paymentMethod,\n        isPaid: this.orderForm.isPaid,\n        totalAmount: this.getTotalAmount()\n      };\n\n      // 提交订单\n      console.log('Submit order data:', orderData);\n\n      // 模拟API请求\n      this.$message.loading('提交中...', 2).then(() => {\n        this.$message.success('订单创建成功');\n        // 提交成功后，跳转到订单列表或详情页\n        this.$router.push('/order/list');\n      });\n    }\n  }\n};","map":{"version":3,"names":["name","data","form","$form","createForm","current","orderForm","customerId","customerName","customerPhone","customerBalance","clothes","remark","paymentMethod","isPaid","customerSearchText","customerSearchResults","isNewCustomer","newCustomer","phone","isMember","initialBalance","clothesModalVisible","clothesModalMode","editingClothesIndex","clothesForm","id","categoryId","categoryName","color","material","price","quantity","specialRequirements","clothesCategories","clothesColumns","title","dataIndex","key","customRender","text","record","toFixed","scopedSlots","methods","next","validateStep1","$message","error","validateStep2","prev","length","searchCustomer","warning","loading","then","mockResults","balance","filter","item","includes","info","selectCustomer","customer","showAddClothesModal","Date","now","editClothes","index","removeClothes","splice","handleClothesModalOk","category","find","push","handleClothesModalCancel","handleCategoryChange","value","getTotalAmount","reduce","sum","submitOrder","orderData","totalAmount","console","log","success","$router"],"sources":["src/views/order/create.vue"],"sourcesContent":["<template>\n  <div class=\"order-create\">\n    <div class=\"page-header\">\n      <h2>录入订单</h2>\n      <p>创建新的洗衣订单</p>\n    </div>\n    \n    <a-card :bordered=\"false\">\n      <a-steps :current=\"current\" size=\"small\">\n        <a-step title=\"客户信息\" />\n        <a-step title=\"衣物信息\" />\n        <a-step title=\"订单确认\" />\n      </a-steps>\n      \n      <!-- 步骤1：客户信息 -->\n      <div v-if=\"current === 0\" class=\"steps-content\">\n        <a-form :form=\"form\" layout=\"vertical\">\n          <a-row :gutter=\"16\">\n            <a-col :span=\"12\">\n              <a-form-item label=\"选择会员\">\n                <a-input-search\n                  v-model=\"customerSearchText\"\n                  placeholder=\"输入会员姓名/手机号搜索\"\n                  enter-button\n                  @search=\"searchCustomer\"\n                />\n              </a-form-item>\n              \n              <div v-if=\"customerSearchResults.length > 0\" class=\"customer-search-results\">\n                <a-list size=\"small\" bordered>\n                  <a-list-item v-for=\"customer in customerSearchResults\" :key=\"customer.id\" @click=\"selectCustomer(customer)\">\n                    <a-list-item-meta>\n                      <template slot=\"title\">\n                        {{ customer.name }} ({{ customer.phone }})\n                      </template>\n                      <template slot=\"description\">\n                        会员ID: {{ customer.id }} | 余额: ¥{{ customer.balance }}\n                      </template>\n                    </a-list-item-meta>\n                    <template slot=\"actions\">\n                      <a-button size=\"small\" type=\"primary\">选择</a-button>\n                    </template>\n                  </a-list-item>\n                </a-list>\n              </div>\n              \n              <div v-if=\"orderForm.customerId\" class=\"selected-customer\">\n                <a-card size=\"small\" title=\"已选择会员\">\n                  <a-descriptions :column=\"1\">\n                    <a-descriptions-item label=\"姓名\">{{ orderForm.customerName }}</a-descriptions-item>\n                    <a-descriptions-item label=\"手机号\">{{ orderForm.customerPhone }}</a-descriptions-item>\n                    <a-descriptions-item label=\"会员ID\">{{ orderForm.customerId }}</a-descriptions-item>\n                    <a-descriptions-item label=\"会员余额\">¥{{ orderForm.customerBalance }}</a-descriptions-item>\n                  </a-descriptions>\n                </a-card>\n              </div>\n            </a-col>\n            \n            <a-col :span=\"12\">\n              <a-form-item label=\"创建新客户\">\n                <a-switch v-model=\"isNewCustomer\" />\n              </a-form-item>\n              \n              <div v-if=\"isNewCustomer\">\n                <a-form-item label=\"姓名\">\n                  <a-input v-model=\"newCustomer.name\" placeholder=\"请输入客户姓名\" />\n                </a-form-item>\n                <a-form-item label=\"手机号\">\n                  <a-input v-model=\"newCustomer.phone\" placeholder=\"请输入手机号\" />\n                </a-form-item>\n                <a-form-item label=\"是否创建会员\">\n                  <a-switch v-model=\"newCustomer.isMember\" />\n                </a-form-item>\n                <div v-if=\"newCustomer.isMember\">\n                  <a-form-item label=\"初始充值\">\n                    <a-input-number v-model=\"newCustomer.initialBalance\" :min=\"0\" :step=\"10\" placeholder=\"请输入初始充值金额\" />\n                  </a-form-item>\n                </div>\n              </div>\n            </a-col>\n          </a-row>\n        </a-form>\n      </div>\n      \n      <!-- 步骤2：衣物信息 -->\n      <div v-if=\"current === 1\" class=\"steps-content\">\n        <div class=\"step-content-header\">\n          <h3>添加衣物信息</h3>\n          <a-button type=\"primary\" icon=\"plus\" @click=\"showAddClothesModal\">添加衣物</a-button>\n        </div>\n        \n        <a-table \n          :columns=\"clothesColumns\" \n          :data-source=\"orderForm.clothes\"\n          :pagination=\"false\"\n          rowKey=\"id\"\n        >\n          <template slot=\"operation\" slot-scope=\"text, record, index\">\n            <a-button type=\"link\" icon=\"edit\" @click=\"editClothes(record, index)\">编辑</a-button>\n            <a-divider type=\"vertical\" />\n            <a-button type=\"link\" icon=\"delete\" @click=\"removeClothes(index)\">删除</a-button>\n          </template>\n        </a-table>\n        \n        <div class=\"order-summary\">\n          <div class=\"order-total\">\n            <span>衣物总数: <a-tag color=\"blue\">{{ orderForm.clothes.length }}</a-tag></span>\n            <span>总金额: <a-tag color=\"green\">¥{{ getTotalAmount() }}</a-tag></span>\n          </div>\n          <div class=\"order-remark\">\n            <a-form-item label=\"订单备注\">\n              <a-textarea v-model=\"orderForm.remark\" :rows=\"2\" placeholder=\"请输入订单备注\" />\n            </a-form-item>\n          </div>\n        </div>\n      </div>\n      \n      <!-- 步骤3：订单确认 -->\n      <div v-if=\"current === 2\" class=\"steps-content\">\n        <a-card title=\"订单信息确认\" :bordered=\"false\">\n          <a-descriptions title=\"客户信息\" :column=\"2\">\n            <a-descriptions-item label=\"客户姓名\">{{ orderForm.customerName }}</a-descriptions-item>\n            <a-descriptions-item label=\"手机号码\">{{ orderForm.customerPhone }}</a-descriptions-item>\n            <a-descriptions-item label=\"会员ID\" v-if=\"orderForm.customerId\">{{ orderForm.customerId }}</a-descriptions-item>\n            <a-descriptions-item label=\"会员余额\" v-if=\"orderForm.customerId\">¥{{ orderForm.customerBalance }}</a-descriptions-item>\n          </a-descriptions>\n          \n          <a-divider />\n          \n          <a-descriptions title=\"衣物信息\" :column=\"1\">\n            <a-descriptions-item label=\"衣物总数\">{{ orderForm.clothes.length }}</a-descriptions-item>\n            <a-descriptions-item label=\"总金额\">¥{{ getTotalAmount() }}</a-descriptions-item>\n          </a-descriptions>\n          \n          <a-table \n            :columns=\"clothesColumns\" \n            :data-source=\"orderForm.clothes\"\n            :pagination=\"false\"\n            size=\"small\"\n            rowKey=\"id\"\n          >\n            <template slot=\"operation\" slot-scope=\"text, record, index\">\n              <a-button type=\"link\" icon=\"edit\" @click=\"editClothes(record, index)\">编辑</a-button>\n              <a-divider type=\"vertical\" />\n              <a-button type=\"link\" icon=\"delete\" @click=\"removeClothes(index)\">删除</a-button>\n            </template>\n          </a-table>\n          \n          <a-divider />\n          \n          <a-descriptions title=\"支付信息\" :column=\"1\">\n            <a-descriptions-item label=\"支付方式\">\n              <a-radio-group v-model=\"orderForm.paymentMethod\">\n                <a-radio value=\"CASH\">现金</a-radio>\n                <a-radio value=\"WECHAT\">微信支付</a-radio>\n                <a-radio value=\"ALIPAY\">支付宝</a-radio>\n                <a-radio value=\"MEMBER_CARD\" :disabled=\"!orderForm.customerId || orderForm.customerBalance < getTotalAmount()\">\n                  会员卡 <a-tag v-if=\"orderForm.customerId\" color=\"blue\">余额: ¥{{ orderForm.customerBalance }}</a-tag>\n                </a-radio>\n              </a-radio-group>\n            </a-descriptions-item>\n            <a-descriptions-item label=\"支付状态\">\n              <a-switch\n                v-model=\"orderForm.isPaid\"\n                checked-children=\"已支付\"\n                un-checked-children=\"未支付\"\n              />\n            </a-descriptions-item>\n            <a-descriptions-item label=\"订单备注\" v-if=\"orderForm.remark\">\n              {{ orderForm.remark }}\n            </a-descriptions-item>\n          </a-descriptions>\n        </a-card>\n      </div>\n      \n      <div class=\"steps-action\">\n        <a-button v-if=\"current > 0\" style=\"margin-right: 8px\" @click=\"prev\">上一步</a-button>\n        <a-button\n          v-if=\"current < 2\"\n          type=\"primary\"\n          @click=\"next\"\n          :disabled=\"(current === 0 && !validateStep1()) || (current === 1 && !validateStep2())\"\n        >\n          下一步\n        </a-button>\n        <a-button v-if=\"current === 2\" type=\"primary\" @click=\"submitOrder\">提交订单</a-button>\n      </div>\n    </a-card>\n    \n    <!-- 添加衣物弹窗 -->\n    <a-modal\n      v-model=\"clothesModalVisible\"\n      :title=\"clothesModalMode === 'add' ? '添加衣物' : '编辑衣物'\"\n      @ok=\"handleClothesModalOk\"\n      @cancel=\"handleClothesModalCancel\"\n      width=\"600px\"\n    >\n      <a-form :form=\"clothesForm\" layout=\"vertical\">\n        <a-row :gutter=\"16\">\n          <a-col :span=\"12\">\n            <a-form-item label=\"衣物类别\">\n              <a-select\n                v-model=\"clothesForm.categoryId\"\n                placeholder=\"请选择衣物类别\"\n                :options=\"clothesCategories\"\n                @change=\"handleCategoryChange\"\n              >\n                <a-select-option v-for=\"cat in clothesCategories\" :key=\"cat.id\" :value=\"cat.id\">\n                  {{ cat.name }}\n                </a-select-option>\n              </a-select>\n            </a-form-item>\n          </a-col>\n          <a-col :span=\"12\">\n            <a-form-item label=\"衣物名称\">\n              <a-input v-model=\"clothesForm.name\" placeholder=\"请输入衣物名称\" />\n            </a-form-item>\n          </a-col>\n        </a-row>\n        \n        <a-row :gutter=\"16\">\n          <a-col :span=\"12\">\n            <a-form-item label=\"颜色\">\n              <a-select v-model=\"clothesForm.color\" placeholder=\"请选择颜色\">\n                <a-select-option value=\"白色\">白色</a-select-option>\n                <a-select-option value=\"黑色\">黑色</a-select-option>\n                <a-select-option value=\"灰色\">灰色</a-select-option>\n                <a-select-option value=\"红色\">红色</a-select-option>\n                <a-select-option value=\"蓝色\">蓝色</a-select-option>\n                <a-select-option value=\"绿色\">绿色</a-select-option>\n                <a-select-option value=\"黄色\">黄色</a-select-option>\n                <a-select-option value=\"其他\">其他</a-select-option>\n              </a-select>\n            </a-form-item>\n          </a-col>\n          <a-col :span=\"12\">\n            <a-form-item label=\"材质\">\n              <a-select v-model=\"clothesForm.material\" placeholder=\"请选择材质\">\n                <a-select-option value=\"棉质\">棉质</a-select-option>\n                <a-select-option value=\"麻质\">麻质</a-select-option>\n                <a-select-option value=\"丝质\">丝质</a-select-option>\n                <a-select-option value=\"毛呢\">毛呢</a-select-option>\n                <a-select-option value=\"皮革\">皮革</a-select-option>\n                <a-select-option value=\"混纺\">混纺</a-select-option>\n                <a-select-option value=\"其他\">其他</a-select-option>\n              </a-select>\n            </a-form-item>\n          </a-col>\n        </a-row>\n        \n        <a-row :gutter=\"16\">\n          <a-col :span=\"12\">\n            <a-form-item label=\"单价\">\n              <a-input-number\n                v-model=\"clothesForm.price\"\n                :min=\"0\"\n                :step=\"1\"\n                placeholder=\"请输入单价\"\n                style=\"width: 100%\"\n              />\n            </a-form-item>\n          </a-col>\n          <a-col :span=\"12\">\n            <a-form-item label=\"数量\">\n              <a-input-number\n                v-model=\"clothesForm.quantity\"\n                :min=\"1\"\n                :step=\"1\"\n                placeholder=\"请输入数量\"\n                style=\"width: 100%\"\n              />\n            </a-form-item>\n          </a-col>\n        </a-row>\n        \n        <a-form-item label=\"特殊处理要求\">\n          <a-checkbox-group v-model=\"clothesForm.specialRequirements\">\n            <a-checkbox value=\"急件\">急件</a-checkbox>\n            <a-checkbox value=\"轻柔洗涤\">轻柔洗涤</a-checkbox>\n            <a-checkbox value=\"特殊熨烫\">特殊熨烫</a-checkbox>\n            <a-checkbox value=\"高温消毒\">高温消毒</a-checkbox>\n            <a-checkbox value=\"去渍处理\">去渍处理</a-checkbox>\n          </a-checkbox-group>\n        </a-form-item>\n        \n        <a-form-item label=\"备注\">\n          <a-textarea v-model=\"clothesForm.remark\" :rows=\"2\" placeholder=\"请输入备注\" />\n        </a-form-item>\n      </a-form>\n    </a-modal>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'OrderCreate',\n  data() {\n    return {\n      form: this.$form.createForm(this),\n      current: 0,\n      orderForm: {\n        customerId: null,\n        customerName: '',\n        customerPhone: '',\n        customerBalance: 0,\n        clothes: [],\n        remark: '',\n        paymentMethod: 'CASH',\n        isPaid: false\n      },\n      customerSearchText: '',\n      customerSearchResults: [],\n      isNewCustomer: false,\n      newCustomer: {\n        name: '',\n        phone: '',\n        isMember: false,\n        initialBalance: 0\n      },\n      clothesModalVisible: false,\n      clothesModalMode: 'add', // 'add' or 'edit'\n      editingClothesIndex: -1,\n      clothesForm: {\n        id: null,\n        categoryId: null,\n        categoryName: '',\n        name: '',\n        color: '',\n        material: '',\n        price: 0,\n        quantity: 1,\n        specialRequirements: [],\n        remark: ''\n      },\n      clothesCategories: [\n        { id: 1, name: '上衣' },\n        { id: 2, name: '裤子' },\n        { id: 3, name: '裙子' },\n        { id: 4, name: '外套' },\n        { id: 5, name: '羽绒服' },\n        { id: 6, name: '床单' },\n        { id: 7, name: '被罩' },\n        { id: 8, name: '窗帘' },\n        { id: 9, name: '鞋子' },\n        { id: 10, name: '包包' },\n        { id: 11, name: '其他' }\n      ],\n      clothesColumns: [\n        {\n          title: '类别',\n          dataIndex: 'categoryName',\n          key: 'categoryName'\n        },\n        {\n          title: '名称',\n          dataIndex: 'name',\n          key: 'name'\n        },\n        {\n          title: '颜色',\n          dataIndex: 'color',\n          key: 'color'\n        },\n        {\n          title: '单价',\n          dataIndex: 'price',\n          key: 'price',\n          customRender: (text) => `¥${text}`\n        },\n        {\n          title: '数量',\n          dataIndex: 'quantity',\n          key: 'quantity'\n        },\n        {\n          title: '金额',\n          key: 'amount',\n          customRender: (text, record) => `¥${(record.price * record.quantity).toFixed(2)}`\n        },\n        {\n          title: '操作',\n          key: 'operation',\n          scopedSlots: { customRender: 'operation' }\n        }\n      ]\n    }\n  },\n  methods: {\n    // 步骤导航\n    next() {\n      if (this.current === 0 && !this.validateStep1()) {\n        this.$message.error('请先选择或创建客户');\n        return;\n      }\n      if (this.current === 1 && !this.validateStep2()) {\n        this.$message.error('请至少添加一件衣物');\n        return;\n      }\n      this.current++;\n    },\n    prev() {\n      this.current--;\n    },\n    \n    // 步骤验证\n    validateStep1() {\n      if (this.isNewCustomer) {\n        return this.newCustomer.name && this.newCustomer.phone;\n      } else {\n        return this.orderForm.customerId && this.orderForm.customerName && this.orderForm.customerPhone;\n      }\n    },\n    validateStep2() {\n      return this.orderForm.clothes && this.orderForm.clothes.length > 0;\n    },\n    \n    // 客户相关\n    searchCustomer() {\n      if (!this.customerSearchText) {\n        this.$message.warning('请输入搜索内容');\n        return;\n      }\n      \n      // 模拟API请求\n      this.$message.loading('搜索中...', 1).then(() => {\n        // 这里应该调用后端API进行搜索\n        const mockResults = [\n          { id: 1, name: '张三', phone: '13800138000', balance: 200 },\n          { id: 2, name: '李四', phone: '13900139000', balance: 350 },\n          { id: 3, name: '王五', phone: '13700137000', balance: 100 }\n        ];\n        \n        this.customerSearchResults = mockResults.filter(item => \n          item.name.includes(this.customerSearchText) || \n          item.phone.includes(this.customerSearchText)\n        );\n        \n        if (this.customerSearchResults.length === 0) {\n          this.$message.info('未找到符合条件的会员');\n        }\n      });\n    },\n    selectCustomer(customer) {\n      this.orderForm.customerId = customer.id;\n      this.orderForm.customerName = customer.name;\n      this.orderForm.customerPhone = customer.phone;\n      this.orderForm.customerBalance = customer.balance;\n      this.isNewCustomer = false;\n      this.customerSearchResults = [];\n      this.customerSearchText = '';\n    },\n    \n    // 衣物相关\n    showAddClothesModal() {\n      this.clothesModalMode = 'add';\n      this.clothesForm = {\n        id: Date.now(),\n        categoryId: null,\n        categoryName: '',\n        name: '',\n        color: '',\n        material: '',\n        price: 0,\n        quantity: 1,\n        specialRequirements: [],\n        remark: ''\n      };\n      this.clothesModalVisible = true;\n    },\n    editClothes(record, index) {\n      this.clothesModalMode = 'edit';\n      this.editingClothesIndex = index;\n      this.clothesForm = { ...record };\n      this.clothesModalVisible = true;\n    },\n    removeClothes(index) {\n      this.orderForm.clothes.splice(index, 1);\n    },\n    handleClothesModalOk() {\n      // 验证表单\n      if (!this.clothesForm.categoryId) {\n        this.$message.error('请选择衣物类别');\n        return;\n      }\n      if (!this.clothesForm.name) {\n        this.$message.error('请输入衣物名称');\n        return;\n      }\n      if (this.clothesForm.price <= 0) {\n        this.$message.error('请输入有效的价格');\n        return;\n      }\n      if (this.clothesForm.quantity <= 0) {\n        this.$message.error('请输入有效的数量');\n        return;\n      }\n      \n      const clothes = { ...this.clothesForm };\n      \n      // 根据类别ID获取类别名称\n      const category = this.clothesCategories.find(item => item.id === clothes.categoryId);\n      if (category) {\n        clothes.categoryName = category.name;\n      }\n      \n      if (this.clothesModalMode === 'add') {\n        this.orderForm.clothes.push(clothes);\n      } else if (this.clothesModalMode === 'edit') {\n        this.orderForm.clothes.splice(this.editingClothesIndex, 1, clothes);\n      }\n      \n      this.clothesModalVisible = false;\n    },\n    handleClothesModalCancel() {\n      this.clothesModalVisible = false;\n    },\n    handleCategoryChange(value) {\n      const category = this.clothesCategories.find(item => item.id === value);\n      if (category) {\n        this.clothesForm.categoryName = category.name;\n      }\n    },\n    \n    // 计算总金额\n    getTotalAmount() {\n      return this.orderForm.clothes.reduce((sum, item) => sum + (item.price * item.quantity), 0).toFixed(2);\n    },\n    \n    // 提交订单\n    submitOrder() {\n      // 处理新客户的逻辑\n      if (this.isNewCustomer) {\n        // 这里应该先调用创建客户的API\n        this.orderForm.customerName = this.newCustomer.name;\n        this.orderForm.customerPhone = this.newCustomer.phone;\n        \n        if (this.newCustomer.isMember) {\n          // 创建会员的逻辑\n          this.orderForm.customerBalance = this.newCustomer.initialBalance;\n        }\n      }\n      \n      // 构建提交的订单数据\n      const orderData = {\n        customerId: this.orderForm.customerId,\n        customerName: this.orderForm.customerName,\n        customerPhone: this.orderForm.customerPhone,\n        clothes: this.orderForm.clothes,\n        remark: this.orderForm.remark,\n        paymentMethod: this.orderForm.paymentMethod,\n        isPaid: this.orderForm.isPaid,\n        totalAmount: this.getTotalAmount()\n      };\n      \n      // 提交订单\n      console.log('Submit order data:', orderData);\n      \n      // 模拟API请求\n      this.$message.loading('提交中...', 2).then(() => {\n        this.$message.success('订单创建成功');\n        // 提交成功后，跳转到订单列表或详情页\n        this.$router.push('/order/list');\n      });\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.order-create {\n  .page-header {\n    margin-bottom: 24px;\n    \n    h2 {\n      margin-bottom: 8px;\n    }\n    \n    p {\n      color: rgba(0, 0, 0, 0.45);\n    }\n  }\n  \n  .steps-content {\n    margin-top: 24px;\n    padding: 24px;\n    background-color: #fafafa;\n    min-height: 200px;\n  }\n  \n  .steps-action {\n    margin-top: 24px;\n  }\n  \n  .customer-search-results {\n    margin-bottom: 16px;\n    max-height: 300px;\n    overflow-y: auto;\n  }\n  \n  .selected-customer {\n    margin-top: 16px;\n  }\n  \n  .step-content-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 16px;\n  }\n  \n  .order-summary {\n    margin-top: 16px;\n    padding-top: 16px;\n    border-top: 1px solid #f0f0f0;\n  }\n  \n  .order-total {\n    display: flex;\n    justify-content: flex-end;\n    gap: 16px;\n    margin-bottom: 16px;\n  }\n}\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}